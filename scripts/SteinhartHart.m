Tc = [-20:110];
T = Tc + 273.15;
R = [146735	138447	130677	123390	116554	110138	104113	98454	93137	88138	83438	79016	74855	70938	67249	63773	60498	57410	54498	51750	49157	46709	44397	42213	40150	38199	36354	34608	32957	31394	29914	28512	27183	25925	24731	23600	22526	21508	20541	19623	18751	17923	17136	16388	15676	15000	14356	13744	13161	12606	12078	11574	11095	10637	10202	9786	9389	9011	8650	8306	7976	7662	7362	7075	6801	6539	6289	6049	5820	5600	5391	5190	4997	4813	4637	4467	4305	4150	4001	3858	3721	3590	3464	3343	3227	3115	3008	2905	2806	2711	2620	2532	2448	2367	2288	2213	2141	2072	2005	1940	1878	1818	1761	1705	1652	1601	1551	1503	1457	1412	1369	1328	1288	1250	1212	1176	1142	1108	1076	1045	1014	985	957	930	903	878	853	829	806	794	762];

% (1/T) = A + (B.*log(R)) + (C.*(log(R)).^3)


%low =36;
%mid = 41;
%hi = 46;
num = 1e6;
A = nan(1,num);
B = nan(1,num);
C = nan(1,num);

for i = 1:num
    
low = randi( [find(Tc == 10) find(Tc == 16)],1);
mid = randi( [find(Tc == 17) find(Tc == 23)],1);
hi = randi( [find(Tc == 24) find(Tc == 30)],1);

T1 = T(low);
T2 = T(mid);
T3 = T(hi);
R1 = R(low);
R2 = R(mid);
R3 = R(hi);

x1 = 1./ T1;
x2 = 1./ T2;
x3 = 1./ T3;
y1 = log(R1);
y2 = log(R2);
y3 = log(R3);

%C = ((x3.*(y1-y2)) - (x1.*(y1-y2)) + (y1.*x1) - (y1.*x2) - (y3.*x1) + (y3.*x2))./ ...
%(((y3.^3).*(y1-y2)) - (y1.*(y2.^3)) + (y1.^4) - ((y1.^3).*(y1-y2)) + (y3.*(y2.^3)) - (y3.*(y1.^3)));   
%B = (x1 - x2 + (C.*(y2.^3)) - (C.*(y1.^3))) ./ (y1-y2);
%A = x2 - (B.*y2) - (C.*(y2.^3));

C(i) = ((x3.*(y1-y2)) - (x1.*(y1-y2)) + (y1.*x1) - (y1.*x2) - (y3.*x1) + (y3.*x2))./ ...
(((y3.^3).*(y1-y2)) - (y1.*(y2.^3)) + (y1.^4) - ((y1.^3).*(y1-y2)) + (y3.*(y2.^3)) - (y3.*(y1.^3)));   
B(i) = (x1 - x2 + (C(i).*(y2.^3)) - (C(i).*(y1.^3))) ./ (y1-y2);
A(i) = x2 - (B(i).*y2) - (C(i).*(y2.^3));
end

sprintf('A: %.20d\n',mean(A))
sprintf('B: %.20d\n',mean(B))
sprintf('C: %.20d\n',mean(C))


%(1/T) = A + (B.*log(R)) + (C.*(log(R)).^3)
estT = 1./ ( mean(A) + (mean(B).* log(R)) + (mean(C).*(log(R).^3))); 
close all

hold on 
plot(R,Tc)
plot(R,estT -273.15,'ro');
hold off